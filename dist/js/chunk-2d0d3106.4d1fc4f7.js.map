{"version":3,"sources":["webpack:///./src/Components/Commons/Editor/index.vue?6e94","webpack:///src/Components/Commons/Editor/index.vue","webpack:///./src/Components/Commons/Editor/index.vue?afad","webpack:///./src/Components/Commons/Editor/index.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","_b","attrs","id","comment","amend","post","form-data","formData","rules","formValidateRules","category","categoryWithoutAbout","active","on","update:active","$event","on-publish","handlePublish","on-cancel","$emit","staticRenderFns","Editorvue_type_script_lang_js_","name","props","String","Boolean","amendValue","Object","components","EditorUI","__webpack_require__","e","then","bind","data","selectedCategory","guestName","title","content","computed","objectSpread","vuex_esm","watch","updateAmendToForm","created","len","length","getData","target","methods","esm_typeof","rest","objectWithoutProperties","ref","_this","validate","_ref","asyncToGenerator","regeneratorRuntime","mark","_callee","valid","postId","commentId","_this$amendValue","isAmend","$confirm","wrap","_context","prev","next","$route","params","confirmButtonText","cancelButtonText","center","sendData","callback","Mixins","$router","$nextTick","$once","t0","abrupt","stop","_x","apply","arguments","Commons_Editorvue_type_script_lang_js_","component","componentNormalizer","__webpack_exports__"],"mappings":"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","file":"js/chunk-2d0d3106.4d1fc4f7.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('EditorUI',_vm._b({attrs:{\"id\":_vm.id,\"comment\":_vm.comment,\"amend\":_vm.amend,\"post\":_vm.post,\"form-data\":_vm.formData,\"rules\":_vm.formValidateRules,\"category\":_vm.categoryWithoutAbout,\"active\":_vm.active},on:{\"update:active\":function($event){_vm.active=$event},\"on-publish\":_vm.handlePublish,\"on-cancel\":function($event){_vm.$emit('on-cancel')}}},'EditorUI',_vm.formData,false,true))}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <EditorUI\r\n      :id=\"id\"\r\n      :comment=\"comment\"\r\n      :amend=\"amend\"\r\n      :post=\"post\"\r\n      :form-data=\"formData\"\r\n      :rules=\"formValidateRules\"\r\n      :category=\"categoryWithoutAbout\"\r\n      :active.sync=\"active\"\r\n      v-bind.sync=\"formData\"\r\n      @on-publish=\"handlePublish\"\r\n      @on-cancel=\"$emit('on-cancel')\"\r\n  />\r\n</template>\r\n\r\n<script>\r\nimport { mapState, mapGetters, mapActions } from 'vuex';\r\nimport { RequestFailed } from '@/Assets/Mixins';\r\nexport default {\r\n  name: 'Editor',\r\n  props: {\r\n    id: String,\r\n    comment: Boolean,\r\n    amend: Boolean,\r\n    post: Boolean,\r\n    amendValue: [Object, Boolean]\r\n  },\r\n\r\n  components: {\r\n    EditorUI: () => import('./EditorUI')\r\n  },\r\n\r\n  data () {\r\n    return {\r\n      active: false,\r\n      formData: {\r\n        selectedCategory: '',\r\n        guestName: '',\r\n        title: '',\r\n        content: ''\r\n      }\r\n    };\r\n  },\r\n\r\n  computed: {\r\n    ...mapState(['formValidateRules']),\r\n    ...mapGetters('Back', ['categoryWithoutAbout'])\r\n  },\r\n\r\n  watch: {\r\n    // 当父组件传入amendValue时就执行初始化将数据填入表单\r\n    amendValue () {\r\n      this.updateAmendToForm();\r\n    }\r\n  },\r\n\r\n  created () {\r\n    // 加载后如没有分类表数据时先发送一次查询请求\r\n    const { comment, post, categoryWithoutAbout } = this;\r\n    const len = categoryWithoutAbout && categoryWithoutAbout.length;\r\n    if (!comment && !!post && len < 1) {\r\n      this.getData({ target: 'categories' });\r\n    }\r\n  },\r\n\r\n  methods: {\r\n    ...mapActions(['getData', 'sendData']),\r\n\r\n    updateAmendToForm () {\r\n      let { amendValue } = this;\r\n      if (typeof amendValue === 'object') {\r\n        const { category: selectedCategory, ...rest } = amendValue;\r\n        this.formData = {\r\n          ...this.formData,\r\n          selectedCategory,\r\n          ...rest\r\n        };\r\n      }\r\n    },\r\n\r\n    // 发表文章/评论\r\n    handlePublish (ref) {\r\n      ref.validate(async (valid) => {\r\n        let category, postId, commentId;\r\n\r\n        if (this.comment && this.amend) {\r\n          // 修改评论\r\n          ({ postId, commentId } = this.amendValue);\r\n        } else if (this.comment) {\r\n          // 新评论\r\n          ({ id: postId } = this.$route.params);\r\n        } else {\r\n          // 修改博文\r\n          category = this.formData.selectedCategory;\r\n          postId = this.amendValue.postId || null;\r\n        }\r\n\r\n        if (valid) {\r\n          const { amend: isAmend, formData, $confirm, comment } = this;\r\n\r\n          try {\r\n            await $confirm('确定发表内容？', {\r\n              title: '确认',\r\n              confirmButtonText: '发布',\r\n              cancelButtonText: '返回',\r\n              center: true\r\n            });\r\n\r\n            await this.sendData({\r\n              ...formData,\r\n              isAmend,\r\n              category,\r\n              postId,\r\n              commentId,\r\n              callback: RequestFailed(this.$router)\r\n            });\r\n\r\n            await this.$nextTick(() => {\r\n              this.formData = {\r\n                selectedCategory: '',\r\n                guestName: '',\r\n                title: '',\r\n                content: ''\r\n              };\r\n              comment && !isAmend\r\n                ? (this.active = false)\r\n                : (this.$once(this.$emit('on-submit')));\r\n            });\r\n          } catch (e) {\r\n            return false;\r\n          }\r\n        }\r\n      });\r\n    }\r\n  }\r\n};\r\n</script>\r\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=1e37119f&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}